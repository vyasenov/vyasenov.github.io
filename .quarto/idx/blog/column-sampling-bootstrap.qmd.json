{"title":"Column-Sampling Bootstrap?","markdown":{"yaml":{"title":"Column-Sampling Bootstrap?","date":"2024-12-16","categories":["bootstrap","statistical inference"]},"headingText":"Background","containsRefs":false,"markdown":"\n\n\nThe bootstrap is a versatile resampling technique traditionally focused on rows. Let’s add a twist to the plain vanilla bootstrap. Imagine you have a wide dataset—many variables but few rows—and want to test the statistical significance of a correlation between two variables. An example is a genetic dataset with thousands of columns (genetic information and outcomes) but a limited number of rows (patients). Can you use the bootstrap to determine if the correlation between a specific gene-outcome pair is statistically significant?\n\nOne creative approach is *resampling columns instead of rows*, generating a distribution of correlation coefficients to assess the significance of your observed correlation.\n\n## A Closer Look\n\n### Definition\n\nHere’s the basic algorithm:\n\n::: {.callout-note title=\"Algorithm:\"}\n1. Randomly sample columns from your dataset with replacement to create fake dataset.\n2. Compute their correlation coefficient.\n3. Repeat this many times.\n4. Compare your observed correlation to the distribution of these synthetic correlations.\n5. Declare statistical significance if the observed correlation appears as an “outlier” in this synthetic distribution.\n:::\n\nThis approach allows you to explore a large number of possible correlations in a computationally efficient way. But does it actually work? Let’s unpack the key considerations.\n\nThe column-sampling bootstrap is most valuable when a dataset has many columns but too few rows for traditional bootstrap methods. The abundance of columns provides a rich sampling landscape. The goal is determining whether a correlation is significantly stronger or weaker than what might occur by chance. Let’s simplify the problem and ignore any issues stemming from being unable to estimate the correlation coefficients well enough.\n\n### Problems\n\nHowever, several critical challenges exist. The method assumes columns are independent and identically distributed (i.i.d.), which rarely holds in practice. Columns often represent related variables—like gene measurements or interconnected phenomena—and these dependencies can bias resampled correlations. Moreover, by resampling columns, you ignore row-level relationships, such as connections in time series or grouped data (like patients from the same household).\n\nInterpreting the null distribution presents another significant challenge. Synthetic correlation coefficients generated through column resampling might not represent a meaningful null hypothesis. If your dataset contains highly correlated features, the null distribution could shift, potentially leading to misleading conclusions. Unlike traditional bootstrapping—where samples reflect a subpopulation—this method lacks that fundamental connection.\n\n### The Verdict\n\nWhile the column-sampling bootstrap is an intriguing concept, it will likely prove useful only in very specific, carefully constrained settings.\n\n## An Example\n\nWhile we should be skeptical of the column-sampling bootstrap in practical applications, it can be instructive to see how we might implement it.\n\nBelow is a sample `R` and `python` code illustrating the main concept. We begin with setting up a synthetic dataset.\n\n:::: {.panel-tabset}\n\n### R\n```r\nrm(list=ls())\nset.seed(1988)\ndata <- as.data.frame(matrix(rnorm(1000), nrow = 50, ncol = 20))\nobserved_correlation <- cor(data[[1]], data[[2]])\n\n# Perform the resampling\nn_bootstrap <- 1000  # Number of bootstrap iterations\nn_columns <- ncol(data)  # Total number of columns in the dataset\nbootstrap_correlations <- numeric(n_bootstrap)\n\nfor (i in 1:n_bootstrap) {\n  resampled_columns <- sample(1:n_columns, size = n_columns, replace = TRUE)\n  resampled_data <- data[, resampled_columns]\n  bootstrap_correlations[i] <- cor(resampled_data[[1]], resampled_data[[2]])\n}\n\n# Test the significance of the observed correlation\np_value <- mean(abs(bootstrap_correlations) >= abs(observed_correlation))\n\n# Print the results\ncat(\"Observed Correlation:\", observed_correlation, \"\\n\")\n> Observed Correlation: 0.05758855 \ncat(\"P-value:\", p_value, \"\\n\")\n> P-value: 0.676 \n```\n\n### Python\n```python\nimport numpy as np\nnp.random.seed(1988)\n\n# Generate synthetic dataset\ndata = np.random.normal(size=(50, 20))  # 50 rows, 20 columns\nobserved_correlation = np.corrcoef(data[:, 0], data[:, 1])[0, 1]\n\n# Perform the resampling\nn_bootstrap = 1000  # Number of bootstrap iterations\nn_columns = data.shape[1]  # Total number of columns in the dataset\nbootstrap_correlations = []\n\nfor _ in range(n_bootstrap):\n    # Resample columns with replacement\n    resampled_columns = np.random.choice(n_columns, size=n_columns, replace=True)\n    resampled_data = data[:, resampled_columns]\n    # Compute correlation between the first two columns of the resampled data\n    bootstrap_correlations.append(np.corrcoef(resampled_data[:, 0], resampled_data[:, 1])[0, 1])\n\n# Test the significance of the observed correlation\nbootstrap_correlations = np.array(bootstrap_correlations)\np_value = np.mean(np.abs(bootstrap_correlations) >= np.abs(observed_correlation))\n\n# Print the results\nprint(\"Observed Correlation:\", observed_correlation)\nprint(\"P-value:\", p_value)\n```\n\n::::\n\nThe observed correlation is quite low and equal to $0.58$. Its associated p-value is $0.676$, consistent with the value not being statistically significant.\n\n\n## Bottom Line\n\n- The column-sampling bootstrap is a thought-provoking twist on traditional resampling techniques that leverages the width of your dataset.\n\n- While it offers computational efficiency and flexibility, its reliance on the i.i.d. assumption and potential to overlook row-level dependencies highlight the need for careful application.\n\n- The column-sampling bootrap should not be your go-to method to assess statistical significance.","srcMarkdownNoYaml":"\n\n## Background\n\nThe bootstrap is a versatile resampling technique traditionally focused on rows. Let’s add a twist to the plain vanilla bootstrap. Imagine you have a wide dataset—many variables but few rows—and want to test the statistical significance of a correlation between two variables. An example is a genetic dataset with thousands of columns (genetic information and outcomes) but a limited number of rows (patients). Can you use the bootstrap to determine if the correlation between a specific gene-outcome pair is statistically significant?\n\nOne creative approach is *resampling columns instead of rows*, generating a distribution of correlation coefficients to assess the significance of your observed correlation.\n\n## A Closer Look\n\n### Definition\n\nHere’s the basic algorithm:\n\n::: {.callout-note title=\"Algorithm:\"}\n1. Randomly sample columns from your dataset with replacement to create fake dataset.\n2. Compute their correlation coefficient.\n3. Repeat this many times.\n4. Compare your observed correlation to the distribution of these synthetic correlations.\n5. Declare statistical significance if the observed correlation appears as an “outlier” in this synthetic distribution.\n:::\n\nThis approach allows you to explore a large number of possible correlations in a computationally efficient way. But does it actually work? Let’s unpack the key considerations.\n\nThe column-sampling bootstrap is most valuable when a dataset has many columns but too few rows for traditional bootstrap methods. The abundance of columns provides a rich sampling landscape. The goal is determining whether a correlation is significantly stronger or weaker than what might occur by chance. Let’s simplify the problem and ignore any issues stemming from being unable to estimate the correlation coefficients well enough.\n\n### Problems\n\nHowever, several critical challenges exist. The method assumes columns are independent and identically distributed (i.i.d.), which rarely holds in practice. Columns often represent related variables—like gene measurements or interconnected phenomena—and these dependencies can bias resampled correlations. Moreover, by resampling columns, you ignore row-level relationships, such as connections in time series or grouped data (like patients from the same household).\n\nInterpreting the null distribution presents another significant challenge. Synthetic correlation coefficients generated through column resampling might not represent a meaningful null hypothesis. If your dataset contains highly correlated features, the null distribution could shift, potentially leading to misleading conclusions. Unlike traditional bootstrapping—where samples reflect a subpopulation—this method lacks that fundamental connection.\n\n### The Verdict\n\nWhile the column-sampling bootstrap is an intriguing concept, it will likely prove useful only in very specific, carefully constrained settings.\n\n## An Example\n\nWhile we should be skeptical of the column-sampling bootstrap in practical applications, it can be instructive to see how we might implement it.\n\nBelow is a sample `R` and `python` code illustrating the main concept. We begin with setting up a synthetic dataset.\n\n:::: {.panel-tabset}\n\n### R\n```r\nrm(list=ls())\nset.seed(1988)\ndata <- as.data.frame(matrix(rnorm(1000), nrow = 50, ncol = 20))\nobserved_correlation <- cor(data[[1]], data[[2]])\n\n# Perform the resampling\nn_bootstrap <- 1000  # Number of bootstrap iterations\nn_columns <- ncol(data)  # Total number of columns in the dataset\nbootstrap_correlations <- numeric(n_bootstrap)\n\nfor (i in 1:n_bootstrap) {\n  resampled_columns <- sample(1:n_columns, size = n_columns, replace = TRUE)\n  resampled_data <- data[, resampled_columns]\n  bootstrap_correlations[i] <- cor(resampled_data[[1]], resampled_data[[2]])\n}\n\n# Test the significance of the observed correlation\np_value <- mean(abs(bootstrap_correlations) >= abs(observed_correlation))\n\n# Print the results\ncat(\"Observed Correlation:\", observed_correlation, \"\\n\")\n> Observed Correlation: 0.05758855 \ncat(\"P-value:\", p_value, \"\\n\")\n> P-value: 0.676 \n```\n\n### Python\n```python\nimport numpy as np\nnp.random.seed(1988)\n\n# Generate synthetic dataset\ndata = np.random.normal(size=(50, 20))  # 50 rows, 20 columns\nobserved_correlation = np.corrcoef(data[:, 0], data[:, 1])[0, 1]\n\n# Perform the resampling\nn_bootstrap = 1000  # Number of bootstrap iterations\nn_columns = data.shape[1]  # Total number of columns in the dataset\nbootstrap_correlations = []\n\nfor _ in range(n_bootstrap):\n    # Resample columns with replacement\n    resampled_columns = np.random.choice(n_columns, size=n_columns, replace=True)\n    resampled_data = data[:, resampled_columns]\n    # Compute correlation between the first two columns of the resampled data\n    bootstrap_correlations.append(np.corrcoef(resampled_data[:, 0], resampled_data[:, 1])[0, 1])\n\n# Test the significance of the observed correlation\nbootstrap_correlations = np.array(bootstrap_correlations)\np_value = np.mean(np.abs(bootstrap_correlations) >= np.abs(observed_correlation))\n\n# Print the results\nprint(\"Observed Correlation:\", observed_correlation)\nprint(\"P-value:\", p_value)\n```\n\n::::\n\nThe observed correlation is quite low and equal to $0.58$. Its associated p-value is $0.676$, consistent with the value not being statistically significant.\n\n\n## Bottom Line\n\n- The column-sampling bootstrap is a thought-provoking twist on traditional resampling techniques that leverages the width of your dataset.\n\n- While it offers computational efficiency and flexibility, its reliance on the i.i.d. assumption and potential to overlook row-level dependencies highlight the need for careful application.\n\n- The column-sampling bootrap should not be your go-to method to assess statistical significance."},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../code/styles.css"],"toc":true,"filters":["code-insertion"],"output-file":"column-sampling-bootstrap.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.24","resources":["../code/open-links-new-tab.js","../code/back-to-top.js"],"theme":{"light":"cosmo","dark":"cyborg"},"header-includes":["<script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=680ee8d89f7a510019a96bcf&product=inline-share-buttons' async='async'></script>\n<script src=\"../code/open-links-new-tab.js\"></script>  \n<script src=\"../code/back-to-top.js\"></script>\n<link href=\"https://fonts.googleapis.com/css2?family=Fira+Code&family=Source+Code+Pro&display=swap\" rel=\"stylesheet\">\n"],"page-layout":"full","includes":{"after-body":["../_includes/comments.html",{"text":"<button id=\"back-to-top\" onclick=\"scrollToTop()\">↑</button>\n"}]},"insert-before-post":"_sharebuttons.md","title":"Column-Sampling Bootstrap?","date":"2024-12-16","categories":["bootstrap","statistical inference"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}