{"title":"The Limits of Semiparametric Models: The Efficiency Bound","markdown":{"yaml":{"title":"The Limits of Semiparametric Models: The Efficiency Bound","date":"2025-01-22","categories":["statistical inference","semiparametric models"]},"headingText":"Background","containsRefs":false,"markdown":"\n\n\nThe efficiency bound is a cornerstone of the academic literature on semiparametric models, and it’s easy to see why. This bound quantifies the potential loss in efficiency (i.e., increase in variance) that arises when opting for a semiparametric model over a fully parametric one. In doing so, it offers a rigorous benchmark for evaluating the asymptotic variance of any estimator. By providing insights into the trade-offs between model flexibility and statistical precision, the efficiency bound occupies a critical role in understanding the theoretical limits of estimation. Despite its importance, this concept and the broader class of semiparametric models remain underappreciated within much of the data science community.\n\nThis article aims to demystify the notion of the semiparametric efficiency bound and its relevance to practical applications. It unpacks the mathematical foundations underlying this concept, shedding light on its relationship with the Cramér-Rao lower bound (CRLB). I will also touch on the bound’s implications for real-world data analysis, where balancing flexibility and efficiency is often a key concern.\n\n## Notation\n\nBefore diving in, let’s establish the necessary notation to guide our technical discussion. The model governing the data is characterized by parameters $\\theta$ and $\\eta$ with likelihood $f(X; \\theta, \\eta)$. \nMoreover:\n\n- $\\theta \\in \\mathbb{R}^d$ is the parameter of interest, a finite-dimensional vector we want to estimate. Often $\\theta$ is a scalar. It represents the parametric component of the model. \n- $\\eta$ is a nuisance parameter, which is infinite-dimensional (e.g., a nonparametric density or function). It is a nuisance in the sense that it is part of the model, but we are not interested in it for its own sake. It represents the nonparametric component of the model.\n\nA leading example is the partially linear model:\n\n$$Y= \\theta X+g(Z)+\\epsilon,$$\n\nwhere $Y$ is the outcome variable, $Z$ represents a vector of covariates, $g(\\cdot)$ is a function characterized by $\\eta$, while $\\epsilon$ is an error term. To fit this model in the likelihood notation above, think of $Z$ as a component of $X$. We assume we have a random i.i.d. sample of all necessary variables.\n\n## A Closer Look\n\nIn semiparametric models, the presence of $\\eta$ complicates the estimation in that it can obscure the relationship between  $\\theta$ and the observed data. The semiparametric efficiency bound generalizes the CRLB by accounting for the nuisance parameter $\\eta$ and isolating the information relevant to $\\theta$.\n\n### Parametric Submodels\n\nLet’s take a sidestep for a minute. A parametric submodel, say $f(\\theta)$, that contains $\\theta$ alone, represents a subset of distributions that satisfy semiparametric assumptions and contains the true distribution $f(X; \\theta, \\eta)$. For any semiparametric estimator that is consistent and asymptotically normal, its asymptotic variance can be compared to the CRLB of the parametric submodel. Since this relationship holds for all possible parametric submodels, the semiparametric estimator’s variance cannot be smaller than any submodel’s bound. In other words, the asymptotic variance of any semiparametric estimator is at least as large as the largest CRLB across all parametric submodels. \n\nInformally,\n\n$$\\text{Var}(\\hat{\\theta}) \\geq \\max_{\\text{{param. submodel}}} \\text{CRLB}.$$\n\nThis is our first insight on the semiparametric efficiency bound, which admittedly is more of theoretical than practical significance.\n\n### Efficient Influence Functions\n\nThe semiparametric efficiency bound depends on the interplay between $\\theta$ and $\\eta$, captured through the something called the **Efficient Influence Function** (EIF). Remember that the score function for $\\theta$,\n\n$$S_\\theta(X)=\\frac{\\partial}{\\partial \\theta} \\log f(X; \\theta, \\eta),$$\n\nmeasures the sensitivity of the log-likelihood to changes in $\\theta$. We can similarly define the score with respect to $\\eta$:\n\n$$S_\\eta(X)=\\frac{\\partial}{\\partial \\eta} \\log f(X; \\theta, \\eta).$$\n\nNow enter the EIF $\\psi^*(X)$ which captures the variation in $\\theta$ while adjusting for the nuisance parameter $\\eta$. It satisfies the orthogonality condition:\n\n$$\\mathbb{E}\\left[ \\psi^*(X) \\cdot S_\\eta(X) \\right] = 0,$$\n\nensuring that the influence of $\\eta$ is removed from $\\psi(X)$. In other words, $\\psi^*(X)$ captures only information about $\\theta$, uncontaminated by nuisance parameters. It is the influence function with the lowest possible variance.\n\n### Efficient Score\n\nThe next piece of the puzzle is the **Efficient Score** $S^*_{\\theta}$, the projection of $S_\\theta(X)$ onto the space orthogonal to the nuisance tangent space $\\mathcal{T}_\\eta$:\n\n$$S^*_{\\theta}(X) = S_\\theta(X)  - \\Pi( S_\\theta(X) \\mid \\mathcal{T}_\\eta),$$\n\nwhere $\\Pi(\\cdot)$ is the projection operator. Here $\\mathcal{T}_\\eta$ is simply the linear subspace spanned by $S_\\eta(X)$. The Efficient Score is the part of the score vector that is “free” from the influence of nuisance parameters. It represents the best possible score function for estimating $\\theta$ in the presence of $\\eta$. (A similar technique underlies the so-called Neyman orthogonality principle in dobule/debiased machine learning.) We can construct the efficient influence function by appropriately scaling the efficient score to get to the optimal EIF.\n\n### The Semiparametric Efficiency Bound\n\nWe are, at last, ready to state the main result. The semiparametric efficiency bound is determined by the variance of the Efficient Score:\n\n$$\\text{Var}(\\hat{\\theta}) \\geq \\frac{1}{\\mathbb{E}[S_\\theta^*(X)^2]}.$$\n\n​\nThis generalizes the Cramér-Rao lower bound for semiparametric models by incorporating the complexity introduced by the nuisance parameter $\\eta$. In parametric models, this bound collapses to and is determined by the Fisher Information, while in here, it is governed by the efficient score.\n\nTo achieve the bound in practice, nuisance parameters are often removed through methods like regression residuals, inverse probability weighting, or targeted maximum likelihood estimation (TMLE). These techniques isolate the information about $\\theta$ from $\\eta$, enabling efficient estimation.\n\n## Bottom Line\n\n- Semiparametric models blend parametric assumptions (related to a parameter of interest) with nonparametric flexibility (related to nuisance parameters).\n\n- The efficient influence function isolates the information about the parameter of interest, removing the impact of nuisance parameters.\n\n- The semiparametric efficiency bound generalizes CRLB to this class of models. It is determined by the variance of the efficient score vector.\n\n- Practical estimation achieving this bound often involves removing nuisance effects through residualization or other adjustment techniques.\n\n## References\n\nBickel, P. J., Klaassen, C. A., Ritov, Y., & Wellner, J. A. (1993)\n\nEfficient and Adaptive Estimation for Semiparametric Models. Johns Hopkins University Press.\n\nGreene, William H. “Econometric analysis”. New Jersey: Prentice Hall (2000): 201-215.\n\nHines, O., Dukes, O., Diaz-Ordaz, K., & Vansteelandt, S. (2022). Demystifying statistical learning based on efficient influence functions. The American Statistician, 76(3), 292-304.\n\nIchimura, H., & Todd, P. (2007) Implementing Nonparametric and Semiparametric Estimators. In Heckman, J. & Leamer, E. (Eds.), Handbook of Econometrics (Vol. 6B).\n\nNewey, W. K. (1990) Semiparametric Efficiency Bounds. Journal of Applied Econometrics, 5(2), 99–135.\n\nTsiatis, A. (2007). Semiparametric theory and missing data. Springer Science & Business Media\n\nVan der Vaart, A. W. (2000) Asymptotic Statistics. Cambridge University Press.","srcMarkdownNoYaml":"\n\n## Background\n\nThe efficiency bound is a cornerstone of the academic literature on semiparametric models, and it’s easy to see why. This bound quantifies the potential loss in efficiency (i.e., increase in variance) that arises when opting for a semiparametric model over a fully parametric one. In doing so, it offers a rigorous benchmark for evaluating the asymptotic variance of any estimator. By providing insights into the trade-offs between model flexibility and statistical precision, the efficiency bound occupies a critical role in understanding the theoretical limits of estimation. Despite its importance, this concept and the broader class of semiparametric models remain underappreciated within much of the data science community.\n\nThis article aims to demystify the notion of the semiparametric efficiency bound and its relevance to practical applications. It unpacks the mathematical foundations underlying this concept, shedding light on its relationship with the Cramér-Rao lower bound (CRLB). I will also touch on the bound’s implications for real-world data analysis, where balancing flexibility and efficiency is often a key concern.\n\n## Notation\n\nBefore diving in, let’s establish the necessary notation to guide our technical discussion. The model governing the data is characterized by parameters $\\theta$ and $\\eta$ with likelihood $f(X; \\theta, \\eta)$. \nMoreover:\n\n- $\\theta \\in \\mathbb{R}^d$ is the parameter of interest, a finite-dimensional vector we want to estimate. Often $\\theta$ is a scalar. It represents the parametric component of the model. \n- $\\eta$ is a nuisance parameter, which is infinite-dimensional (e.g., a nonparametric density or function). It is a nuisance in the sense that it is part of the model, but we are not interested in it for its own sake. It represents the nonparametric component of the model.\n\nA leading example is the partially linear model:\n\n$$Y= \\theta X+g(Z)+\\epsilon,$$\n\nwhere $Y$ is the outcome variable, $Z$ represents a vector of covariates, $g(\\cdot)$ is a function characterized by $\\eta$, while $\\epsilon$ is an error term. To fit this model in the likelihood notation above, think of $Z$ as a component of $X$. We assume we have a random i.i.d. sample of all necessary variables.\n\n## A Closer Look\n\nIn semiparametric models, the presence of $\\eta$ complicates the estimation in that it can obscure the relationship between  $\\theta$ and the observed data. The semiparametric efficiency bound generalizes the CRLB by accounting for the nuisance parameter $\\eta$ and isolating the information relevant to $\\theta$.\n\n### Parametric Submodels\n\nLet’s take a sidestep for a minute. A parametric submodel, say $f(\\theta)$, that contains $\\theta$ alone, represents a subset of distributions that satisfy semiparametric assumptions and contains the true distribution $f(X; \\theta, \\eta)$. For any semiparametric estimator that is consistent and asymptotically normal, its asymptotic variance can be compared to the CRLB of the parametric submodel. Since this relationship holds for all possible parametric submodels, the semiparametric estimator’s variance cannot be smaller than any submodel’s bound. In other words, the asymptotic variance of any semiparametric estimator is at least as large as the largest CRLB across all parametric submodels. \n\nInformally,\n\n$$\\text{Var}(\\hat{\\theta}) \\geq \\max_{\\text{{param. submodel}}} \\text{CRLB}.$$\n\nThis is our first insight on the semiparametric efficiency bound, which admittedly is more of theoretical than practical significance.\n\n### Efficient Influence Functions\n\nThe semiparametric efficiency bound depends on the interplay between $\\theta$ and $\\eta$, captured through the something called the **Efficient Influence Function** (EIF). Remember that the score function for $\\theta$,\n\n$$S_\\theta(X)=\\frac{\\partial}{\\partial \\theta} \\log f(X; \\theta, \\eta),$$\n\nmeasures the sensitivity of the log-likelihood to changes in $\\theta$. We can similarly define the score with respect to $\\eta$:\n\n$$S_\\eta(X)=\\frac{\\partial}{\\partial \\eta} \\log f(X; \\theta, \\eta).$$\n\nNow enter the EIF $\\psi^*(X)$ which captures the variation in $\\theta$ while adjusting for the nuisance parameter $\\eta$. It satisfies the orthogonality condition:\n\n$$\\mathbb{E}\\left[ \\psi^*(X) \\cdot S_\\eta(X) \\right] = 0,$$\n\nensuring that the influence of $\\eta$ is removed from $\\psi(X)$. In other words, $\\psi^*(X)$ captures only information about $\\theta$, uncontaminated by nuisance parameters. It is the influence function with the lowest possible variance.\n\n### Efficient Score\n\nThe next piece of the puzzle is the **Efficient Score** $S^*_{\\theta}$, the projection of $S_\\theta(X)$ onto the space orthogonal to the nuisance tangent space $\\mathcal{T}_\\eta$:\n\n$$S^*_{\\theta}(X) = S_\\theta(X)  - \\Pi( S_\\theta(X) \\mid \\mathcal{T}_\\eta),$$\n\nwhere $\\Pi(\\cdot)$ is the projection operator. Here $\\mathcal{T}_\\eta$ is simply the linear subspace spanned by $S_\\eta(X)$. The Efficient Score is the part of the score vector that is “free” from the influence of nuisance parameters. It represents the best possible score function for estimating $\\theta$ in the presence of $\\eta$. (A similar technique underlies the so-called Neyman orthogonality principle in dobule/debiased machine learning.) We can construct the efficient influence function by appropriately scaling the efficient score to get to the optimal EIF.\n\n### The Semiparametric Efficiency Bound\n\nWe are, at last, ready to state the main result. The semiparametric efficiency bound is determined by the variance of the Efficient Score:\n\n$$\\text{Var}(\\hat{\\theta}) \\geq \\frac{1}{\\mathbb{E}[S_\\theta^*(X)^2]}.$$\n\n​\nThis generalizes the Cramér-Rao lower bound for semiparametric models by incorporating the complexity introduced by the nuisance parameter $\\eta$. In parametric models, this bound collapses to and is determined by the Fisher Information, while in here, it is governed by the efficient score.\n\nTo achieve the bound in practice, nuisance parameters are often removed through methods like regression residuals, inverse probability weighting, or targeted maximum likelihood estimation (TMLE). These techniques isolate the information about $\\theta$ from $\\eta$, enabling efficient estimation.\n\n## Bottom Line\n\n- Semiparametric models blend parametric assumptions (related to a parameter of interest) with nonparametric flexibility (related to nuisance parameters).\n\n- The efficient influence function isolates the information about the parameter of interest, removing the impact of nuisance parameters.\n\n- The semiparametric efficiency bound generalizes CRLB to this class of models. It is determined by the variance of the efficient score vector.\n\n- Practical estimation achieving this bound often involves removing nuisance effects through residualization or other adjustment techniques.\n\n## References\n\nBickel, P. J., Klaassen, C. A., Ritov, Y., & Wellner, J. A. (1993)\n\nEfficient and Adaptive Estimation for Semiparametric Models. Johns Hopkins University Press.\n\nGreene, William H. “Econometric analysis”. New Jersey: Prentice Hall (2000): 201-215.\n\nHines, O., Dukes, O., Diaz-Ordaz, K., & Vansteelandt, S. (2022). Demystifying statistical learning based on efficient influence functions. The American Statistician, 76(3), 292-304.\n\nIchimura, H., & Todd, P. (2007) Implementing Nonparametric and Semiparametric Estimators. In Heckman, J. & Leamer, E. (Eds.), Handbook of Econometrics (Vol. 6B).\n\nNewey, W. K. (1990) Semiparametric Efficiency Bounds. Journal of Applied Econometrics, 5(2), 99–135.\n\nTsiatis, A. (2007). Semiparametric theory and missing data. Springer Science & Business Media\n\nVan der Vaart, A. W. (2000) Asymptotic Statistics. Cambridge University Press."},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../code/styles.css"],"toc":true,"include-in-header":[{"text":"<script src=\"../code/open-links-new-tab.js\"></script>\n"}],"output-file":"limits-semiparam-models.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.24","resources":["../code/open-links-new-tab.js"],"theme":{"light":"cosmo","dark":"cyborg"},"page-layout":"full","title":"The Limits of Semiparametric Models: The Efficiency Bound","date":"2025-01-22","categories":["statistical inference","semiparametric models"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}