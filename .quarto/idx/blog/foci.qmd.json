{"title":"FOCI: A New Variable Selection Method","markdown":{"yaml":{"title":"FOCI: A New Variable Selection Method","date":"2024-06-11","categories":["variable selection","machine learning"]},"headingText":"Background","containsRefs":false,"markdown":"\n\n\nIn our data-abundant world, we often have access to tens, hundreds, or even thousands of variables. Most of these features are usually irrelevant or redundant, leading to increased computational complexity and potentially overfit models. Variable selection algorithms are designed to mitigate these challenges by selecting the subset of columns that is most relevant to the problem at hand. This, in turn, can result in simplified, more efficient, and interpretable machine learning (ML) models. Examples of such methods abound—lasso, ridge, elastic net utilizing $L1$ and $L2$ regularization or a linear combination of both; forward/backward stepwise regression algorithms, etc.\n\nIn this article, I will describe a new variable selection method built on the idea of Chatterjee’s correlation coefficient, which has been a hot topic of discussion among statisticians. The new method goes by the abbreviation FOCI, which stands for Feature Ordering by Conditional Independence. It is somewhat similar to forward stepwise regression but overcomes some of the critiques most often associated with it.\n\nLet’s start with setting up some basic notation. We are focused on studying the correlation between ($Y$) (e.g., income) and ($X$) (education level) while interested in conditioning on/controlling for ($Z$) (parental education and other factors). As always, we are armed with a random sample of size n of all these variables and assume everything is well-behaved. If you have not had a chance, I recommend you first read my earlier post on Chatterjee’s correlation measure, which lays some of the foundations necessary to understand the algorithm under the hood.\n\n## A Closer Look\n\nI will be being with taking you on a tour of conditional and unconditional statistics. What’s the deal with conditional versus unconditional correlation, and is one of them always a better choice than the other?\n\n### Conditional and Unconditional Correlation\n\nMost times, when we talk about the correlation between $X$ and $Y$, knowingly or not, we mean unconditional correlation. This is the correlation between two variables without considering any additional or contextual factors. As such, it describes their relationship “in general.” In my previous post, I illustrated several ways to measure such unconditional correlations, including the well-known Spearman correlation coefficient.\n\nIn some cases, however, we like to go one step further and consider contextual factors. This is where conditional correlation comes in. It considers the influence of one or more additional variables when measuring the relationship between $X$ and $Y$. Thus, it provides information on how their relationship changes under specific conditions.\n\nConditional correlation is hard (pun intended); it’s even [NP-hard](https://doi.org/10.1016/0004-3702(93)90036-B) in some contexts.\n\nUnder certain assumptions, it might be possible to go from conditional to unconditional correlation. Simplifying the example above, let’s say that $Z$ (parental education) can take on two values—low and high. If we have measures of the correlation between $X$ and $Y$ for each of these values (i.e., for families with low and high parental education), we can weigh these by their relative proportion and arrive at an estimate of the unconditional correlation between $X$ and $Y$.\n\nTo answer my own question above, it’s difficult to say that one is always better than the other. It really depends on your goal. If you want to know how $X$ and $Y$ vary in general, unconditional correlation is your friend; if, instead, you are interested in incorporating contextual information or simply controlling for other factors, you really want conditional correlation. My take is that most often we are after conditional correlations but use tools for measuring unconditional ones.\n\n### Quantile Regression\n\n::: {.callout-note title=\"Side Note on Quantile Regression\"}\n\n[Quantile regression](https://doi.org/10.1146/annurev-economics-063016-103651) is another setting where most often people confuse conditional and [unconditional statistical inference](https://onlinelibrary.wiley.com/doi/abs/10.3982/ECTA6822). Interestingly, though, the situation is flipped. The classical quantile regression estimator, which most people utilize, measures the impact of $X$ on the *conditional* quantile of $Y$, but there results are [commonly](https://doi.org/10.1002/hec.2927) [interpreted](interpreted) as having unconditional interpretation.\n\n:::\n\n### New Coefficient of Conditional Independence\n\n[Azadkia and Chatterjee (2021)](http://10.0.4.190/21-AOS2073) develop a new coefficient of conditional correlation. The math behind is in extremely involved and I will not even be discussing its formula here. For simplicity, let’s just call it $T(\\cdot)$:\n\n$$T(Y,X|Z) = \\text{corr} (Y, X | Z).$$\n\n$T(\\cdot)$ enjoys the following attractive properties:\n\n- It is an extension of Chatterjee’s unconditional correlation coefficient.\n- It is non-parametric.\n- It has no tuning parameters.\n- It can be estimated quickly, in $O(n \\text{ log}n)$ time.\n- Asymptotically converges to a limit in $[0,1]$. It’s limit is $0$ when $Y$ and $X$ are conditionally independent, and it is $1$ when $Y$ is a measurable function of $X$, conditionally.\n- It is a nonlinear generalization of the partial $R^2$ coefficient in a linear regression of $Y$ on $X$ and $Z$.\n\nAll this is to say – $T(\\cdot)$ has many things going for it, and it is a pretty good measure of conditional correlation.\n\n### The Variable Selection Algorithm\n\nThe key idea is to integrate $T(\\cdot)$ into a forward stepwise variable selection procedure. Let’s add the $Z$ variables into $X$, so we only have $Y\\in \\mathbb{R}$ and $X\\in \\mathbb{R}^p$. Then the algorithm goes as follows:\n\n::: {.callout-note title=\"Algorithm:\"}\n1. Start with the index $j$ that maximizes $T(Y \\mid X_j)$.\n2. Given $j_1, \\dots j_k$, select $j_{k+1}$ as the index $\\notin (j_1, \\dots j_k)$ that maximizes $T(Y,X_j \\mid X_{j_1}, \\dots, X_{j_k})$.\n3. Continue until finding the first $k$ such that $T(Y, X_{j_{k+1}} \\mid X_{j_1}, \\dots, X_{j_k}) \\leq 0$.\n4. Declare the set of selected variables $\\hat{S} ={X_{j_1}, \\dots, X_{j_k}}$.\n:::\n\n*Software Package*: [FOCI](https://www.rdocumentation.org/packages/FOCI)\n\nIn words, we start with the variable j that maximizes $T(Y\\mid X_j)$. In each subsequent step we select the variable that has not yet been selected and has the highest $T(Y \\mid \\cdot)$ value up until $T(Y \\mid \\cdot)$ is positive. That’s it. We then have the set of FOCI selected variables.\n\nAlthough it is not required theoretically, the predictor variables be standardized before running the algorithm. If computational time is not an issue, one can try to add $m \\geq  2$ variables at each step instead of just one.\n\nThere you have it. Grab your data and see whether and how much FOCI improves on your favorite feature selection method.\n\n## Bottom Line\n\n- Azadkia and Chatterjee (2021) develop a new coefficient of conditional correlation featuring a host of attractive properties.\n\n- This coefficient can be used in a stepwise inclusion fashion as a variable selection algorithm potentially improving on well-established methods in the field.\n\n## Where to Learn More\n\nMy earlier post on Chatterjee’s bivariate coefficient of (unconditional) correlation is a good starting point. Data scientists more deeply interested in FOCI should read Azadkia and Chatterjee's paper which describes in detail the mathematics behind the new algorithm.\n\n## References\n\nAlejo, J., Favata, F., Montes-Rojas, G., & Trombetta, M. (2021). Conditional vs Unconditional Quantile Regression Models: A Guide to Practitioners. Economia, 44(88), 76-93.\n\nAzadkia, M., & Chatterjee, S. (2021). A simple measure of conditional dependence. The Annals of Statistics, 49(6), 3070-3102.\n\nBorah, B. J., & Basu, A. (2013). Highlighting differences between conditional and unconditional quantile regression approaches through an application to assess medication adherence. Health economics, 22(9), 1052-1070.\n\nChatterjee, S. (2021). A new coefficient of correlation. Journal of the American Statistical Association, 116(536), 2009-2022.\n\nDagum, P., & Luby, M. (1993). Approximating probabilistic inference in Bayesian belief networks is NP-hard. Artificial intelligence, 60(1), 141-153.\n\nFirpo, S., Fortin, N. M., & Lemieux, T. (2009). Unconditional quantile regressions. Econometrica, 77(3), 953-973.\n\nKoenker, R. (2017). Quantile regression: 40 years on. Annual review of economics, 9, 155-176.","srcMarkdownNoYaml":"\n\n## Background\n\nIn our data-abundant world, we often have access to tens, hundreds, or even thousands of variables. Most of these features are usually irrelevant or redundant, leading to increased computational complexity and potentially overfit models. Variable selection algorithms are designed to mitigate these challenges by selecting the subset of columns that is most relevant to the problem at hand. This, in turn, can result in simplified, more efficient, and interpretable machine learning (ML) models. Examples of such methods abound—lasso, ridge, elastic net utilizing $L1$ and $L2$ regularization or a linear combination of both; forward/backward stepwise regression algorithms, etc.\n\nIn this article, I will describe a new variable selection method built on the idea of Chatterjee’s correlation coefficient, which has been a hot topic of discussion among statisticians. The new method goes by the abbreviation FOCI, which stands for Feature Ordering by Conditional Independence. It is somewhat similar to forward stepwise regression but overcomes some of the critiques most often associated with it.\n\nLet’s start with setting up some basic notation. We are focused on studying the correlation between ($Y$) (e.g., income) and ($X$) (education level) while interested in conditioning on/controlling for ($Z$) (parental education and other factors). As always, we are armed with a random sample of size n of all these variables and assume everything is well-behaved. If you have not had a chance, I recommend you first read my earlier post on Chatterjee’s correlation measure, which lays some of the foundations necessary to understand the algorithm under the hood.\n\n## A Closer Look\n\nI will be being with taking you on a tour of conditional and unconditional statistics. What’s the deal with conditional versus unconditional correlation, and is one of them always a better choice than the other?\n\n### Conditional and Unconditional Correlation\n\nMost times, when we talk about the correlation between $X$ and $Y$, knowingly or not, we mean unconditional correlation. This is the correlation between two variables without considering any additional or contextual factors. As such, it describes their relationship “in general.” In my previous post, I illustrated several ways to measure such unconditional correlations, including the well-known Spearman correlation coefficient.\n\nIn some cases, however, we like to go one step further and consider contextual factors. This is where conditional correlation comes in. It considers the influence of one or more additional variables when measuring the relationship between $X$ and $Y$. Thus, it provides information on how their relationship changes under specific conditions.\n\nConditional correlation is hard (pun intended); it’s even [NP-hard](https://doi.org/10.1016/0004-3702(93)90036-B) in some contexts.\n\nUnder certain assumptions, it might be possible to go from conditional to unconditional correlation. Simplifying the example above, let’s say that $Z$ (parental education) can take on two values—low and high. If we have measures of the correlation between $X$ and $Y$ for each of these values (i.e., for families with low and high parental education), we can weigh these by their relative proportion and arrive at an estimate of the unconditional correlation between $X$ and $Y$.\n\nTo answer my own question above, it’s difficult to say that one is always better than the other. It really depends on your goal. If you want to know how $X$ and $Y$ vary in general, unconditional correlation is your friend; if, instead, you are interested in incorporating contextual information or simply controlling for other factors, you really want conditional correlation. My take is that most often we are after conditional correlations but use tools for measuring unconditional ones.\n\n### Quantile Regression\n\n::: {.callout-note title=\"Side Note on Quantile Regression\"}\n\n[Quantile regression](https://doi.org/10.1146/annurev-economics-063016-103651) is another setting where most often people confuse conditional and [unconditional statistical inference](https://onlinelibrary.wiley.com/doi/abs/10.3982/ECTA6822). Interestingly, though, the situation is flipped. The classical quantile regression estimator, which most people utilize, measures the impact of $X$ on the *conditional* quantile of $Y$, but there results are [commonly](https://doi.org/10.1002/hec.2927) [interpreted](interpreted) as having unconditional interpretation.\n\n:::\n\n### New Coefficient of Conditional Independence\n\n[Azadkia and Chatterjee (2021)](http://10.0.4.190/21-AOS2073) develop a new coefficient of conditional correlation. The math behind is in extremely involved and I will not even be discussing its formula here. For simplicity, let’s just call it $T(\\cdot)$:\n\n$$T(Y,X|Z) = \\text{corr} (Y, X | Z).$$\n\n$T(\\cdot)$ enjoys the following attractive properties:\n\n- It is an extension of Chatterjee’s unconditional correlation coefficient.\n- It is non-parametric.\n- It has no tuning parameters.\n- It can be estimated quickly, in $O(n \\text{ log}n)$ time.\n- Asymptotically converges to a limit in $[0,1]$. It’s limit is $0$ when $Y$ and $X$ are conditionally independent, and it is $1$ when $Y$ is a measurable function of $X$, conditionally.\n- It is a nonlinear generalization of the partial $R^2$ coefficient in a linear regression of $Y$ on $X$ and $Z$.\n\nAll this is to say – $T(\\cdot)$ has many things going for it, and it is a pretty good measure of conditional correlation.\n\n### The Variable Selection Algorithm\n\nThe key idea is to integrate $T(\\cdot)$ into a forward stepwise variable selection procedure. Let’s add the $Z$ variables into $X$, so we only have $Y\\in \\mathbb{R}$ and $X\\in \\mathbb{R}^p$. Then the algorithm goes as follows:\n\n::: {.callout-note title=\"Algorithm:\"}\n1. Start with the index $j$ that maximizes $T(Y \\mid X_j)$.\n2. Given $j_1, \\dots j_k$, select $j_{k+1}$ as the index $\\notin (j_1, \\dots j_k)$ that maximizes $T(Y,X_j \\mid X_{j_1}, \\dots, X_{j_k})$.\n3. Continue until finding the first $k$ such that $T(Y, X_{j_{k+1}} \\mid X_{j_1}, \\dots, X_{j_k}) \\leq 0$.\n4. Declare the set of selected variables $\\hat{S} ={X_{j_1}, \\dots, X_{j_k}}$.\n:::\n\n*Software Package*: [FOCI](https://www.rdocumentation.org/packages/FOCI)\n\nIn words, we start with the variable j that maximizes $T(Y\\mid X_j)$. In each subsequent step we select the variable that has not yet been selected and has the highest $T(Y \\mid \\cdot)$ value up until $T(Y \\mid \\cdot)$ is positive. That’s it. We then have the set of FOCI selected variables.\n\nAlthough it is not required theoretically, the predictor variables be standardized before running the algorithm. If computational time is not an issue, one can try to add $m \\geq  2$ variables at each step instead of just one.\n\nThere you have it. Grab your data and see whether and how much FOCI improves on your favorite feature selection method.\n\n## Bottom Line\n\n- Azadkia and Chatterjee (2021) develop a new coefficient of conditional correlation featuring a host of attractive properties.\n\n- This coefficient can be used in a stepwise inclusion fashion as a variable selection algorithm potentially improving on well-established methods in the field.\n\n## Where to Learn More\n\nMy earlier post on Chatterjee’s bivariate coefficient of (unconditional) correlation is a good starting point. Data scientists more deeply interested in FOCI should read Azadkia and Chatterjee's paper which describes in detail the mathematics behind the new algorithm.\n\n## References\n\nAlejo, J., Favata, F., Montes-Rojas, G., & Trombetta, M. (2021). Conditional vs Unconditional Quantile Regression Models: A Guide to Practitioners. Economia, 44(88), 76-93.\n\nAzadkia, M., & Chatterjee, S. (2021). A simple measure of conditional dependence. The Annals of Statistics, 49(6), 3070-3102.\n\nBorah, B. J., & Basu, A. (2013). Highlighting differences between conditional and unconditional quantile regression approaches through an application to assess medication adherence. Health economics, 22(9), 1052-1070.\n\nChatterjee, S. (2021). A new coefficient of correlation. Journal of the American Statistical Association, 116(536), 2009-2022.\n\nDagum, P., & Luby, M. (1993). Approximating probabilistic inference in Bayesian belief networks is NP-hard. Artificial intelligence, 60(1), 141-153.\n\nFirpo, S., Fortin, N. M., & Lemieux, T. (2009). Unconditional quantile regressions. Econometrica, 77(3), 953-973.\n\nKoenker, R. (2017). Quantile regression: 40 years on. Annual review of economics, 9, 155-176."},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../code/styles.css"],"toc":true,"include-in-header":[{"text":"<script src=\"../code/open-links-new-tab.js\"></script>\n"}],"filters":["code-insertion"],"output-file":"foci.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.24","resources":["../code/open-links-new-tab.js"],"theme":{"light":"cosmo","dark":"cyborg"},"header-includes":["<script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=680ee8d89f7a510019a96bcf&product=inline-share-buttons' async='async'></script>"],"page-layout":"full","includes":{"after-body":["../_includes/comments.html"]},"insert-before-post":"_sharebuttons.md","title":"FOCI: A New Variable Selection Method","date":"2024-06-11","categories":["variable selection","machine learning"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}