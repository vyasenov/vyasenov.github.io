{"title":"Weak Instruments in Causal Inference: A Data Scientist's Guide","markdown":{"yaml":{"title":"Weak Instruments in Causal Inference: A Data Scientist's Guide","date":"2025-00-00","categories":["causal inference","instrumental variables"]},"headingText":"Background","containsRefs":false,"markdown":"\n\n\nInstrumental variables (IV) methods are a cornerstone of causal inference, especially when dealing with endogeneity. But IV’s strength is only as good as the quality of its instruments. If your instruments are weak — meaning they barely explain variation in the endogenous regressor — all the nice properties of IV break down, sometimes spectacularly so.\n\nThis article provides a detailed, chronological walkthrough of the weak instruments literature, following the recent review by Keane and Neal (2024). Along the way, we’ll revisit some classics (Bound et al. 1995, Staiger & Stock 1997), discuss critical developments like the Anderson-Rubin (AR) and Conditional Likelihood Ratio (CLR) tests, and explain why many conventional practices can lead us astray. Whether you're doing causal inference in economics, health, or social science, understanding these pitfalls is crucial.\n\n## Notation\n\nConsider the structural equation:\n\n$$\ny = x \\beta + u, \\quad \\text{with} \\; \\text{cov}(x, u) \\neq 0.\n$$\n\nHere:\n- $y$ is the outcome.\n- $x$ is the endogenous regressor.\n- $u$ is the structural error term.\n\nWe also have an instrument $z$ satisfying:\n- **Relevance**: $\\text{cov}(z, x) \\neq 0$,\n- **Exogeneity**: $\\text{cov}(z, u) = 0$.\n\nThe first-stage equation is:\n\n$$\nx = z \\pi + e,\n$$\n\nwhere $e$ is the first-stage error.\n\n## A Closer Look\n\n### The Early Warnings: Bias and Size Distortion\n\nThe weak instrument problem was first highlighted by Bound et al. (1995), who showed that when instruments are weak, the Two-Stage Least Squares (2SLS) estimator behaves badly:\n- The **bias** of 2SLS drifts toward the Ordinary Least Squares (OLS) bias.\n- The **size** of the 2SLS $t$-test inflates — the $5\\%$ test rejects more than $5\\%$ of the time.\n\nStaiger and Stock (1997) proposed the famous rule of thumb: **first-stage $F > 10$**. If your first-stage $F$-statistic is below 10, trouble looms.\n\n### Size Isn't Everything: The Power Asymmetry Problem\n\nKeane and Neal (2024) show that even with strong instruments (F well above 10), 2SLS suffers from **power asymmetry**:\n- Standard errors are spuriously small when the 2SLS estimate drifts toward OLS.\n- Estimates near OLS appear artificially precise, leading to inflated power to detect false positives.\n- Meanwhile, true effects far from OLS are harder to detect.\n\nThis is not just a weak instrument problem — it affects 2SLS broadly.\n\n### The Anderson-Rubin (AR) and Conditional Likelihood Ratio (CLR) Tests\n\nThe AR test, introduced in 1949 (!), avoids power asymmetry by focusing on the reduced-form relationship:\n\n$$\ny = z \\gamma + \\varepsilon.\n$$\n\nThe AR test is valid even with weak instruments and does not suffer from the same distortion as the 2SLS $t$-test. When there are multiple instruments, the **CLR test** (Moreira 2003, Kleibergen 2005) generalizes this approach.\n\n::: {.callout-note title=\"Algorithm: Anderson-Rubin Test\"}\n1. Estimate the first-stage regression of $x$ on $z$.\n2. Compute fitted values $\\hat{x}$.\n3. Regress $y$ on $\\hat{x}$ (ignoring standard errors).\n4. Use the residual variance from this regression to construct the AR test statistic.\n:::\n\n### When Is OLS Better Than 2SLS?\n\nA provocative insight from the recent literature is that when first-stage $F$ is between $10$ and $20$, **OLS may be closer to the truth than 2SLS**, unless endogeneity is very severe.\n\nThe logic: If instruments barely move $x$, the small amount of exogenous variation they provide may not be enough to outweigh the imprecision of 2SLS.\n\n---\n\n## An Example\n\n::::{.panel-tabset}\n\n### R\n\n```r\nset.seed(123)\nn <- 1000\nz <- rnorm(n)\nx <- 0.1 * z + rnorm(n)\ny <- 0.5 * x + 0.5 * rnorm(n)\n\nfirst_stage <- lm(x ~ z)\nsummary(first_stage)\n\nsecond_stage <- lm(y ~ fitted(first_stage))\nsummary(second_stage)\n```\n\n### Python\n\n```python\nimport numpy as np\nimport pandas as pd\nimport statsmodels.api as sm\n\nnp.random.seed(123)\nn = 1000\nz = np.random.randn(n)\nx = 0.1 * z + np.random.randn(n)\ny = 0.5 * x + 0.5 * np.random.randn(n)\n\nX = sm.add_constant(z)\nfirst_stage = sm.OLS(x, X).fit()\nx_hat = first_stage.fittedvalues\n\nX2 = sm.add_constant(x_hat)\nsecond_stage = sm.OLS(y, X2).fit()\nprint(second_stage.summary())\n```\n\n::::\n\n## Bottom Line\n\n- Weak instruments bias 2SLS toward OLS and inflate $t$-test size.\n\n- Power asymmetry causes 2SLS to favor false positives near OLS.\n\n- AR and CLR tests avoid these issues and should be preferred.\n\n- OLS may outperform 2SLS when instruments are weak, unless endogeneity is severe.\n\n## Where to Learn More\n\nThe recent review by Keane and Neal (2024) provides a practical and readable guide to the weak instruments literature. For deeper theory, see Bound et al. (1995), Staiger & Stock (1997), and Stock & Yogo (2005). Modern software packages like `ivreg` in `R` and `linearmodels` in Python support these methods.\n\n## References\n\n- Bound, J., Jaeger, D. A., & Baker, R. M. (1995). Problems with Instrumental Variables Estimation When the Correlation Between the Instruments and the Endogenous Explanatory Variable Is Weak. *Journal of the American Statistical Association*, 90(430), 443–450.\n\n- Staiger, D., & Stock, J. H. (1997). Instrumental Variables Regression with Weak Instruments. *Econometrica*, 65(3), 557–586.\n\n- Stock, J. H., & Yogo, M. (2005). Testing for Weak Instruments in Linear IV Regression. *Identification and Inference for Econometric Models*.\n\n- Keane, M. P., & Neal, T. (2024). A Practical Guide to Weak Instruments. *Annual Review of Economics*, 16, 185–212.\n","srcMarkdownNoYaml":"\n\n## Background\n\nInstrumental variables (IV) methods are a cornerstone of causal inference, especially when dealing with endogeneity. But IV’s strength is only as good as the quality of its instruments. If your instruments are weak — meaning they barely explain variation in the endogenous regressor — all the nice properties of IV break down, sometimes spectacularly so.\n\nThis article provides a detailed, chronological walkthrough of the weak instruments literature, following the recent review by Keane and Neal (2024). Along the way, we’ll revisit some classics (Bound et al. 1995, Staiger & Stock 1997), discuss critical developments like the Anderson-Rubin (AR) and Conditional Likelihood Ratio (CLR) tests, and explain why many conventional practices can lead us astray. Whether you're doing causal inference in economics, health, or social science, understanding these pitfalls is crucial.\n\n## Notation\n\nConsider the structural equation:\n\n$$\ny = x \\beta + u, \\quad \\text{with} \\; \\text{cov}(x, u) \\neq 0.\n$$\n\nHere:\n- $y$ is the outcome.\n- $x$ is the endogenous regressor.\n- $u$ is the structural error term.\n\nWe also have an instrument $z$ satisfying:\n- **Relevance**: $\\text{cov}(z, x) \\neq 0$,\n- **Exogeneity**: $\\text{cov}(z, u) = 0$.\n\nThe first-stage equation is:\n\n$$\nx = z \\pi + e,\n$$\n\nwhere $e$ is the first-stage error.\n\n## A Closer Look\n\n### The Early Warnings: Bias and Size Distortion\n\nThe weak instrument problem was first highlighted by Bound et al. (1995), who showed that when instruments are weak, the Two-Stage Least Squares (2SLS) estimator behaves badly:\n- The **bias** of 2SLS drifts toward the Ordinary Least Squares (OLS) bias.\n- The **size** of the 2SLS $t$-test inflates — the $5\\%$ test rejects more than $5\\%$ of the time.\n\nStaiger and Stock (1997) proposed the famous rule of thumb: **first-stage $F > 10$**. If your first-stage $F$-statistic is below 10, trouble looms.\n\n### Size Isn't Everything: The Power Asymmetry Problem\n\nKeane and Neal (2024) show that even with strong instruments (F well above 10), 2SLS suffers from **power asymmetry**:\n- Standard errors are spuriously small when the 2SLS estimate drifts toward OLS.\n- Estimates near OLS appear artificially precise, leading to inflated power to detect false positives.\n- Meanwhile, true effects far from OLS are harder to detect.\n\nThis is not just a weak instrument problem — it affects 2SLS broadly.\n\n### The Anderson-Rubin (AR) and Conditional Likelihood Ratio (CLR) Tests\n\nThe AR test, introduced in 1949 (!), avoids power asymmetry by focusing on the reduced-form relationship:\n\n$$\ny = z \\gamma + \\varepsilon.\n$$\n\nThe AR test is valid even with weak instruments and does not suffer from the same distortion as the 2SLS $t$-test. When there are multiple instruments, the **CLR test** (Moreira 2003, Kleibergen 2005) generalizes this approach.\n\n::: {.callout-note title=\"Algorithm: Anderson-Rubin Test\"}\n1. Estimate the first-stage regression of $x$ on $z$.\n2. Compute fitted values $\\hat{x}$.\n3. Regress $y$ on $\\hat{x}$ (ignoring standard errors).\n4. Use the residual variance from this regression to construct the AR test statistic.\n:::\n\n### When Is OLS Better Than 2SLS?\n\nA provocative insight from the recent literature is that when first-stage $F$ is between $10$ and $20$, **OLS may be closer to the truth than 2SLS**, unless endogeneity is very severe.\n\nThe logic: If instruments barely move $x$, the small amount of exogenous variation they provide may not be enough to outweigh the imprecision of 2SLS.\n\n---\n\n## An Example\n\n::::{.panel-tabset}\n\n### R\n\n```r\nset.seed(123)\nn <- 1000\nz <- rnorm(n)\nx <- 0.1 * z + rnorm(n)\ny <- 0.5 * x + 0.5 * rnorm(n)\n\nfirst_stage <- lm(x ~ z)\nsummary(first_stage)\n\nsecond_stage <- lm(y ~ fitted(first_stage))\nsummary(second_stage)\n```\n\n### Python\n\n```python\nimport numpy as np\nimport pandas as pd\nimport statsmodels.api as sm\n\nnp.random.seed(123)\nn = 1000\nz = np.random.randn(n)\nx = 0.1 * z + np.random.randn(n)\ny = 0.5 * x + 0.5 * np.random.randn(n)\n\nX = sm.add_constant(z)\nfirst_stage = sm.OLS(x, X).fit()\nx_hat = first_stage.fittedvalues\n\nX2 = sm.add_constant(x_hat)\nsecond_stage = sm.OLS(y, X2).fit()\nprint(second_stage.summary())\n```\n\n::::\n\n## Bottom Line\n\n- Weak instruments bias 2SLS toward OLS and inflate $t$-test size.\n\n- Power asymmetry causes 2SLS to favor false positives near OLS.\n\n- AR and CLR tests avoid these issues and should be preferred.\n\n- OLS may outperform 2SLS when instruments are weak, unless endogeneity is severe.\n\n## Where to Learn More\n\nThe recent review by Keane and Neal (2024) provides a practical and readable guide to the weak instruments literature. For deeper theory, see Bound et al. (1995), Staiger & Stock (1997), and Stock & Yogo (2005). Modern software packages like `ivreg` in `R` and `linearmodels` in Python support these methods.\n\n## References\n\n- Bound, J., Jaeger, D. A., & Baker, R. M. (1995). Problems with Instrumental Variables Estimation When the Correlation Between the Instruments and the Endogenous Explanatory Variable Is Weak. *Journal of the American Statistical Association*, 90(430), 443–450.\n\n- Staiger, D., & Stock, J. H. (1997). Instrumental Variables Regression with Weak Instruments. *Econometrica*, 65(3), 557–586.\n\n- Stock, J. H., & Yogo, M. (2005). Testing for Weak Instruments in Linear IV Regression. *Identification and Inference for Econometric Models*.\n\n- Keane, M. P., & Neal, T. (2024). A Practical Guide to Weak Instruments. *Annual Review of Economics*, 16, 185–212.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../code/styles.css"],"toc":true,"include-in-header":[{"text":"<script src=\"../code/open-links-new-tab.js\"></script>\n"}],"output-file":"weak-iv-review.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.24","resources":["../code/open-links-new-tab.js"],"theme":{"light":"cosmo","dark":"cyborg"},"page-layout":"full","title":"Weak Instruments in Causal Inference: A Data Scientist's Guide","date":"2025-00-00","categories":["causal inference","instrumental variables"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}